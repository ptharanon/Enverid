<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual Control - ESP32 Test Server</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <nav class="navbar">
        <div class="nav-brand">SSS Cartridge Test</div>
        <div class="nav-menu">
            <a href="/">Auto</a>
            <a href="/manual" class="active">Manual</a>
            <a href="/results">Results</a>
        </div>
    </nav>

    <div class="container">
        <div class="manual-content">
            <h2>Manual Control</h2>
            
            <div class="status-display">
                <div class="status-row">
                    <span>ESP32 Status:</span>
                    <span id="esp32_status" class="status-badge status-{{ 'online' if status.esp32_connected else 'offline' }}">
                        {{ status.system_status }}
                    </span>
                </div>
            </div>

            <div class="manual-control-panel">
                <h3>Direct ESP32 Control</h3>
                
                <div class="input-group">
                    <label>Fan Voltage</label>
                    <input type="number" id="manual_fan_volt" min="0" max="10" step="0.1" value="0">
                    <span>volt</span>
                </div>

                <div class="input-group">
                    <label>Heater Temperature</label>
                    <input type="number" id="manual_heater_temp" min="0" max="500" step="1" value="0">
                    <span>Â°C (0 = OFF, >0 = ON)</span>
                </div>

                <button id="sendManualCmd" class="btn btn-primary btn-lg">Send Command</button>
                
                <div class="help-text">
                    <p><strong>Note:</strong> Manual commands will put ESP32 in MANUAL mode.</p>
                    <p>Set both values to 0 to safely idle the system.</p>
                </div>
            </div>

            <!-- Quick Presets -->
            <div class="preset-panel">
                <h3>Quick Presets</h3>
                <button class="btn btn-secondary" onclick="setManualPreset(0, 0)">Idle (0V, OFF)</button>
                <button class="btn btn-secondary" onclick="setManualPreset(5, 0)">Fan 5V, Heater OFF</button>
                <button class="btn btn-secondary" onclick="setManualPreset(5, 200)">Fan 5V, Heater ON</button>
                <button class="btn btn-secondary" onclick="setManualPreset(9, 0)">Fan 9V, Heater OFF</button>
                <button class="btn btn-secondary" onclick="setManualPreset(10, 250)">Max Fan, Heater ON</button>
            </div>

            <!-- Response Log -->
            <div class="log-panel">
                <h3>Command Log</h3>
                <div id="manual_log" class="log-output"></div>
                <button id="clearManualLog" class="btn btn-secondary btn-sm">Clear Log</button>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/manual.js') }}"></script>
</body>
</html>
